import { r as i, j as e, g as Y, e as $, b as v, C as P, v as q, F, x as I, y as b } from "./vendor-DsNSJXVB.js";
import { d as D } from "./vendor-redux-CF_v3iJm.js";
import { u as H, s as K, M as W, a as J, D as m, P as Q, C as X } from "./index-D_uz0qJu.js";
import { T as Z } from "./index-83omGegK.js";
const ee = "flex flex-col gap-1 text-[14px] font-normal", te = "form__input h-[60px] border border-[#555] bg-[#040A0A] p-4 placeholder:text-[#555] text-[14px] font-normal tracking-[.56px] outline-none aria-[invalid=true]:placeholder:text-[#FF3A44] aria-[invalid=true]:border-[#FF3A44]", d = i.memo(({ label: o, placeholder: c, type: a = "text", register: l, error: p, autoComplete: u = "on" }) => e.jsxs("label", { className: ee, children: [o, e.jsx("input", { className: te, placeholder: c, type: a, ...l, autoComplete: u, "aria-invalid": !!p })] })), j = i.memo(({ title: o, children: c }) => e.jsxs("section", { className: "form-section flex flex-col gap-1 [&:not(:first-child)]:mt-16", children: [e.jsx("h3", { className: "section-title text-[14px] text-light-turquoise font-bold uppercase", children: o }), e.jsx("div", { className: "flex flex-col gap-5 mt-5", children: c })] })), re = i.memo(({ applyPromoCode: o, register: c }) => e.jsxs("div", { className: "promo-code-input h-[60px] flex items-center", children: [e.jsx("input", { className: "promo-input h-[60px] w-[160px] border border-[#555] bg-[#040A0A] p-4 placeholder:text-[#555] text-[14px] font-normal tracking-[.56px] outline-none  aria-[invalid=true]:placeholder:text-[#FF3A44] aria-[invalid=true]:border-[#FF3A44]", placeholder: "\u041F\u0440\u043E\u043C\u043E\u043A\u043E\u0434", type: "text", ...c }), e.jsx("button", { type: "button", onClick: o, className: "apply-promo-btn border-[.5px] w-[190px] h-full p-4 text-[12px] font-bold tracking-[1.2px] border-light-turquoise uppercase hover:bg-light-turquoise hover:text-[black] focus:border-light-turquoise active:shadow-[0_0_10px_0_#01281F_inset] transition", children: "\u041F\u0440\u0438\u043C\u0435\u043D\u0438\u0442\u044C" })] })), se = i.memo(({ suggestions: o, onSelect: c }) => e.jsx("ul", { className: "suggestion-list", children: o.map((a) => {
  var _a;
  return e.jsxs("li", { onClick: () => c(a), className: "suggestion-item", children: [e.jsx("h4", { children: a.title.text }), e.jsx("span", { children: (_a = a.subtitle) == null ? void 0 : _a.text })] }, a.distance.value);
}) })), oe = i.memo(({ finalPrice: o, discount: c, deliveryPrice: a, appliedPromo: l }) => e.jsxs("div", { className: "summary flex flex-col gap-2 mt-16", children: [e.jsxs("div", { className: "flex gap-24", children: [e.jsx("h2", { className: "text-[30px] text-light-turquoise font-bold uppercase", children: "\u041E\u0431\u0449\u0430\u044F \u0441\u0443\u043C\u043C\u0430 \u0437\u0430\u043A\u0430\u0437\u0430" }), e.jsxs("h2", { className: "text-[30px] text-light-turquoise font-bold uppercase", children: [o, " \u20BD"] })] }), e.jsxs("div", { className: "flex flex-col gap-4", children: [e.jsxs("h3", { className: "text-[14px] font-normal uppercase", children: ["\u0421\u043A\u0438\u0434\u043A\u0430: ", c, " \u20BD (", l == null ? void 0 : l.percentageDiscount, "%)"] }), e.jsxs("h3", { className: "text-[14px] font-normal uppercase", children: ["\u0414\u043E\u0441\u0442\u0430\u0432\u043A\u0430: ", a, " \u20BD"] })] })] })), ae = ["\u0421\u0430\u043C\u043E\u0432\u044B\u0432\u043E\u0437", "\u0414\u043E\u0441\u0442\u0430\u0432\u043A\u0430 \u043A\u0443\u0440\u044C\u0435\u0440\u043E\u043C"], le = ["\u0411\u0430\u043D\u043A\u043E\u0432\u0441\u043A\u0430\u044F \u043A\u0430\u0440\u0442\u0430", "\u041D\u0430\u043B\u0438\u0447\u043D\u044B\u043C\u0438", "Apple pay", "Google pay", "\u041A\u0440\u0438\u043F\u0442\u043E\u0432\u0430\u043B\u044E\u0442\u0430", "\u0421 \u0440\u0430\u0441\u0447\u0435\u0442\u043D\u043E\u0433\u043E \u0441\u0447\u0435\u0442\u0430"], ce = { name: "", phone: "", email: "", secondPhone: "", receiverName: "", comment: "", deliveryRadioGroup: "\u0421\u0430\u043C\u043E\u0432\u044B\u0432\u043E\u0437", payRadioGroupOptions: "\u0411\u0430\u043D\u043A\u043E\u0432\u0441\u043A\u0430\u044F \u043A\u0430\u0440\u0442\u0430", promoCode: "", address: "", apartmentNumber: "", deliveryTime: "" }, ie = i.memo(({ submitOrder: o, totalPrice: c, sendAlert: a }) => {
  const { register: l, handleSubmit: p, control: u, watch: t, getValues: x, setValue: h, formState: { errors: n } } = Y({ defaultValues: ce }), [f, O] = i.useState(0), [L, R] = i.useState(0), [g, T] = i.useState(c), [_, E] = i.useState(), [N, M] = i.useState(void 0), [z, k] = i.useState(false), w = t("deliveryRadioGroup"), B = t("payRadioGroupOptions"), G = async () => {
    const s = x("promoCode").trim().toLowerCase();
    if (!s) return alert("\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043F\u0440\u043E\u043C\u043E\u043A\u043E\u0434");
    if (N) return alert("\u041F\u0440\u043E\u043C\u043E\u043A\u043E\u0434 \u0443\u0436\u0435 \u043F\u0440\u0438\u043C\u0435\u043D\u0451\u043D");
    const r = await U(s);
    if (!r) return a("error");
    const A = g * r.percentageDiscount / 100;
    O(Number(A.toFixed(2))), T(g - A), M(r), a("success");
  }, U = async (s) => {
    try {
      const { data: r } = await v.get(`http://localhost:3000/api/promocode/${s}`);
      return r;
    } catch (r) {
      console.log(r);
    }
  }, y = $(async () => {
    const s = x("address").trim();
    if (s) try {
      const { data: r } = await v.get(`https://suggest-maps.yandex.ru/v1/suggest?apikey=YOUR_API_KEY&text=${s}&lang=ru&results=20`);
      E(r.results), k(true);
    } catch {
      console.log("\u041E\u0448\u0438\u0431\u043A\u0430 \u043F\u043E\u043B\u0443\u0447\u0435\u043D\u0438\u044F \u0430\u0434\u0440\u0435\u0441\u0430"), a("error");
    }
  }, 350), V = (s) => {
    var _a;
    const r = `${((_a = s.subtitle) == null ? void 0 : _a.text) ?? ""}, ${s.title.text}`;
    h("address", r), R(Math.round(Math.random() * 900 + 100)), k(false);
  }, S = (s) => {
    o(s, g, x("address").trim(), N);
  }, C = (s) => {
    a("error"), console.log(s);
  };
  return e.jsxs("form", { onSubmit: p(S, C), className: "order__forms_block w-[540px]", children: [e.jsxs(j, { title: "\u041A\u043E\u043D\u0442\u0430\u043A\u0442\u043D\u044B\u0435 \u0434\u0430\u043D\u043D\u044B\u0435", children: [e.jsx(d, { label: "\u0412\u0430\u0448\u0435 \u0438\u043C\u044F*", placeholder: "\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0432\u0430\u0448\u0435 \u0438\u043C\u044F", register: l("name", { required: true }), error: n.name }), e.jsx(d, { label: "\u0412\u0430\u0448 \u0442\u0435\u043B\u0435\u0444\u043E\u043D*", placeholder: "+7 (977) 777-77-77", type: "tel", register: l("phone", { required: true }), error: n.phone }), e.jsx(d, { label: "\u0412\u0430\u0448 e-mail*", placeholder: "\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0432\u0430\u0448\u0443 \u043F\u043E\u0447\u0442\u0443", type: "email", register: l("email", { required: true }), error: n.email }), e.jsx(d, { label: "\u0422\u0435\u043B\u0435\u0444\u043E\u043D \u043F\u043E\u043B\u0443\u0447\u0430\u0442\u0435\u043B\u044F (\u043D\u0435\u043E\u0431\u044F\u0437\u0430\u0442\u0435\u043B\u044C\u043D\u043E)", placeholder: "+7 (977) 777-77-77", type: "tel", register: l("secondPhone") }), e.jsx(d, { label: "\u0418\u043C\u044F \u043F\u043E\u043B\u0443\u0447\u0430\u0442\u0435\u043B\u044F (\u043D\u0435\u043E\u0431\u044F\u0437\u0430\u0442\u0435\u043B\u044C\u043D\u043E)", placeholder: "\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0438\u043C\u044F \u043F\u043E\u043B\u0443\u0447\u0430\u0442\u0435\u043B\u044F", register: l("receiverName") }), e.jsx(d, { label: "\u041A\u043E\u043C\u043C\u0435\u043D\u0442\u0430\u0440\u0438\u0439 \u043A \u0437\u0430\u043A\u0430\u0437\u0443", placeholder: "\u041F\u0440\u0438\u043C\u0435\u0447\u0430\u043D\u0438\u044F \u043A \u0432\u0430\u0448\u0435\u043C\u0443 \u0437\u0430\u043A\u0430\u0437\u0443", register: l("comment") })] }), e.jsxs(j, { title: "\u0414\u043E\u0441\u0442\u0430\u0432\u043A\u0430", children: [e.jsx(P, { control: u, name: "deliveryRadioGroup", render: ({ field: s }) => e.jsx(q, { ...s, children: ae.map((r) => e.jsx(F, { value: r, control: e.jsx(I, { sx: { color: b[900], "&.Mui-checked": { color: b[50] } } }), label: r, className: "text-[#353535] font-normal aria-checked:text-[white] uppercase tracking-normal", "aria-checked": w === r }, r)) }) }), w === "\u0414\u043E\u0441\u0442\u0430\u0432\u043A\u0430 \u043A\u0443\u0440\u044C\u0435\u0440\u043E\u043C" && e.jsxs(e.Fragment, { children: [e.jsx(d, { label: "\u0410\u0434\u0440\u0435\u0441*", placeholder: "\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0430\u0434\u0440\u0435\u0441", register: l("address", { required: true, onChange: y }), error: n.address, autoComplete: "off" }), e.jsxs("div", { className: "flex gap-8", children: [e.jsx(d, { label: "\u041A\u0432/\u043E\u0444\u0438\u0441", placeholder: "\u041A\u0432/\u043E\u0444\u0438\u0441", register: l("address", { required: true, onChange: y }), error: n.address, autoComplete: "off" }), e.jsx(d, { label: "\u0412\u0440\u0435\u043C\u044F \u0434\u043E\u0441\u0442\u0430\u0432\u043A\u0438", placeholder: "__/__", register: l("address", { required: true, onChange: y }), error: n.address, autoComplete: "off" })] }), z && _ && e.jsx(se, { suggestions: _, onSelect: V })] })] }), e.jsx(j, { title: "\u041E\u043F\u043B\u0430\u0442\u0430", children: e.jsx(P, { control: u, name: "payRadioGroupOptions", render: ({ field: s }) => e.jsx(q, { ...s, children: le.map((r) => e.jsx(F, { value: r, control: e.jsx(I, { sx: { color: b[900], "&.Mui-checked": { color: b[50] } } }), label: r, className: "text-[#353535] font-normal aria-checked:text-[white] uppercase tracking-normal", "aria-checked": B === r }, r)) }) }) }), e.jsx(j, { title: "\u041F\u0440\u043E\u043C\u043E\u043A\u043E\u0434", children: e.jsx(re, { applyPromoCode: G, register: l("promoCode") }) }), e.jsx(oe, { finalPrice: g, discount: f, deliveryPrice: L, appliedPromo: N }), e.jsxs("div", { className: "total_price__button_block flex flex-col gap-[10px] mt-7", children: [e.jsx("button", { onClick: p(S, C), type: "submit", className: "w-[255px] mt-2 transition-all cursor-pointer text-[black] text-[12px] border border-light-turquoise font-bold tracking-[1.2px] uppercase bg-light-turquoise p-4 hover:border-cherry hover:bg-cherry hover:text-[white] focus:border focus:border-cherry active:bg-cherry active:text-[white] active:shadow-[0_0_10px_0_#1B000E_inset]", children: "\u041A \u043E\u043F\u043B\u0430\u0442\u0435" }), e.jsxs("p", { className: "max-w-[342px] text-[10px] font-normal tracking-[0.2px] font-roboto_condensed", children: ["\u041D\u0430\u0436\u0438\u043C\u0430\u044F \u043D\u0430 \u043A\u043D\u043E\u043F\u043A\u0443 \xAB\u041A \u041E\u043F\u043B\u0430\u0442\u0435\xBB, \u044F \u0434\u0430\u044E \u0441\u0432\u043E\u0435 \u0441\u043E\u0433\u043B\u0430\u0441\u0438\u0435 \u043D\u0430 \u043E\u0431\u0440\u0430\u0431\u043E\u0442\u043A\u0443 \u043F\u0435\u0440\u0441\u043E\u043D\u0430\u043B\u044C\u043D\u044B\u0445 \u0434\u0430\u043D\u043D\u044B\u0445, \u0432 \u0441\u043E\u043E\u0442\u0432\u0435\u0442\u0441\u0442\u0432\u0438\u0438 \u0441", e.jsx("span", { className: "text-pink underline ml-1", children: "\u041F\u043E\u043B\u0438\u0442\u0438\u043A\u043E\u0439 \u043A\u043E\u043D\u0444\u0438\u0434\u0435\u043D\u0446\u0438\u0430\u043B\u044C\u043D\u043E\u0441\u0442\u0438" }), ", \u0430 \u0442\u0430\u043A \u0436\u0435 \u043E\u0437\u043D\u0430\u043A\u043E\u043C\u043B\u0435\u043D \u0441 \u0443\u0441\u043B\u043E\u0432\u0438\u044F\u043C\u0438 \u043E\u043F\u043B\u0430\u0442\u044B \u0438 \u0434\u043E\u0441\u0442\u0430\u0432\u043A\u0438"] })] })] });
}), ne = [{ text: "\u0413\u043B\u0430\u0432\u043D\u0430\u044F", path: "/" }, { text: "\u043E\u0444\u043E\u0440\u043C\u043B\u0435\u043D\u0438\u0435 \u0437\u0430\u043A\u0430\u0437\u0430", path: "/order" }], de = "flex items-center  h-[100px] text-[100px] font-normal font-cormorant tracking-[2px] uppercase", pe = "flex items-center ml-[95px] h-[100px] text-[100px] font-normal font-cormorant tracking-[2px] uppercase", xe = "order__title relative z-10 mt-16", be = () => {
  const o = H(), { cartItems: c, totalPrice: a } = D((t) => t.cart), l = i.useCallback((t, x, h, n) => {
    const f = { name: t.name, phoneNumber: t.phone, email: t.email, secondPhoneNumber: t.secondPhone, receiverName: t.receiverName, comment: t.comment, deliveryMethod: t.deliveryRadioGroup, paymentMethod: t.payRadioGroupOptions, cartItems: c, finalPrice: x, ...h && { address: { deliveryAddress: h, apartmentNumber: t.apartmentNumber, deliveryTime: t.deliveryTime } }, ...n && { appliedPromoCode: n } };
    u(f);
  }, [o]), p = i.useCallback((t) => {
    o(K({ modalType: W.Alert, isOpen: true })), o(J({ severity: t }));
  }, [o]), u = async (t) => {
    try {
      await v.post("http://localhost:3000/api/order/", t), p("success");
    } catch (x) {
      console.log("\u041E\u0448\u0438\u0431\u043A\u0430 \u043F\u043E\u0434\u0442\u0432\u0435\u0440\u0436\u0434\u0435\u043D\u0438\u044F \u0437\u0430\u043A\u0430\u0437\u0430", x), p("error");
    }
  };
  return e.jsxs("div", { className: "order_page relative pt-[120px] pb-[200px] max-h-[3000px] bg-[#040A0A]", children: [e.jsx(m, { className: "absolute w-[217px] h-[174px] blur-[125px] bg-light-turquoise rounded-[50%] -rotate-[71.859deg] -top-[5rem] -left-[4rem] z-10" }), e.jsx("img", { src: "./img/PagesImg/OrderImg/FlowerBgLeft.png", className: "absolute top-0 left-0 z-20" }), e.jsx("img", { src: "./img/PagesImg/OrderImg/FlowerBgFirstRight.png", className: "absolute top-0 right-0 z-20" }), e.jsx("img", { src: "./img/PagesImg/OrderImg/FlowerBgSecondRight.png", className: "absolute top-0 right-0 z-20" }), e.jsx(m, { className: "absolute w-[504px] h-[625px] blur-[125px] bg-cherry rounded-[50%] -top-[5rem] right-0 z-10" }), e.jsx(m, { className: "absolute w-[403px] h-[211px] blur-[125px] bg-light-turquoise rounded-[50%] top-[80rem] right-0 z-[15]" }), e.jsx(m, { className: "absolute w-[355px] h-[365px] blur-[125px] bg-cherry rounded-[50%] top-[88rem] right-[5rem] z-10" }), e.jsxs("div", { className: "order_page__wrapper mx-auto container relative z-30", children: [e.jsx(Q, { items: ne }), e.jsx(Z, { title: "\u043E\u0444\u043E\u0440\u043C\u043B\u0435\u043D\u0438\u0435", subtitle: "\u0437\u0430\u043A\u0430\u0437\u0430", titleClassName: de, subtitleClassName: pe, wrapperClassName: xe }), e.jsxs("div", { className: "order_block mt-20", children: [e.jsx("h2", { className: "text-[30px] text-light-turquoise font-bold uppercase", children: "\u041E\u0444\u043E\u0440\u043C\u043B\u0435\u043D\u0438\u0435 \u0437\u0430\u043A\u0430\u0437\u0430" }), e.jsxs("div", { className: "order__content_block flex justify-between mt-10 w-full", children: [e.jsx(ie, { submitOrder: l, totalPrice: a, sendAlert: p }), e.jsxs("div", { className: "order__cart_items", children: [e.jsx("h3", { className: "form_title text-[14px] text-light-turquoise font-bold uppercase", children: "\u0412\u0430\u0448 \u0437\u0430\u043A\u0430\u0437:" }), e.jsx("div", { className: "cart_items flex flex-col w-[350px] [&:first-of-type]:border-t border-[#555] mt-11", children: c.map((t) => e.jsx(X, { id: t.id, name: t.name, cost: t.cost, imageUrl: t.imageUrl, quantity: t.quantity, dispatch: o }, t.id)) }), e.jsxs("h3", { className: "text-[14px] text-light-turquoise font-bold tracking-[0.28px] uppercase mt-5", children: ["\u041F\u0440\u0435\u0434\u0432\u0430\u0440\u0438\u0442\u0435\u043B\u044C\u043D\u044B\u0439 \u0438\u0442\u043E\u0433: ", a, " \u0440\u0443\u0431."] })] })] })] })] }), e.jsx(m, { className: "absolute w-[100px] h-[211px] blur-[125px] bg-light-turquoise rounded-[50%] rotate-[21.097deg] -bottom-[3rem] left-0 z-10" }), e.jsx(m, { className: "absolute w-[700px] h-[211px] blur-[125px] bg-light-turquoise rounded-[50%] rotate-[21.097deg] -bottom-[12rem] right-[35%] z-10" }), e.jsx(m, { className: "absolute w-[355px] h-[365px] blur-[125px] bg-cherry rounded-[50%] -bottom-[8rem] right-0 z-10" })] });
};
export {
  be as default
};
