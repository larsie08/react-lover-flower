import { r as i, j as e, g as Y, e as $, b as v, C as P, v as q, F, x as I, y as b } from "./vendor-DsNSJXVB.js";
import { d as D } from "./vendor-redux-CF_v3iJm.js";
import { u as H, s as K, M as W, a as J, D as d, P as Q, C as X } from "./index-DEteCQ4C.js";
import { T as Z } from "./index-BtP6gyP3.js";
const ee = "flex flex-col gap-1 text-[14px] font-normal max-lg:max-w-[300px]", te = "form__input h-[60px] w-full border border-[#555] bg-[#040A0A] p-4 placeholder:text-[#555] text-[14px] font-normal tracking-[.56px] outline-none aria-[invalid=true]:placeholder:text-[#FF3A44] aria-[invalid=true]:border-[#FF3A44]", n = i.memo(({ label: l, placeholder: c, type: a = "text", register: o, error: p, autoComplete: g = "on" }) => e.jsxs("label", { className: ee, children: [l, e.jsx("input", { className: te, placeholder: c, type: a, ...o, autoComplete: g, "aria-invalid": !!p })] })), f = i.memo(({ title: l, children: c }) => e.jsxs("section", { className: "form-section flex flex-col gap-1 [&:not(:first-child)]:mt-16", children: [e.jsx("h3", { className: "section-title text-[14px] text-light-turquoise font-bold uppercase", children: l }), e.jsx("div", { className: "flex flex-col gap-5 mt-5", children: c })] })), re = i.memo(({ applyPromoCode: l, register: c }) => e.jsxs("div", { className: "promo-code-input flex h-[60px] w-full items-center", children: [e.jsx("input", { className: "promo-input h-[60px] flex-1 border border-[#555] bg-[#040A0A] p-4 text-[14px] font-normal tracking-[.56px] outline-none placeholder:text-[#555] aria-[invalid=true]:border-[#FF3A44] aria-[invalid=true]:placeholder:text-[#FF3A44] max-lg:max-w-[130px] lg:w-[160px]", placeholder: "\u041F\u0440\u043E\u043C\u043E\u043A\u043E\u0434", type: "text", ...c }), e.jsx("button", { type: "button", onClick: l, className: "apply-promo-btn h-full flex-1 border-[.5px] border-light-turquoise p-4 text-[12px] font-bold uppercase tracking-[1.2px] transition hover:bg-light-turquoise hover:text-[black] focus:border-light-turquoise active:shadow-[0_0_10px_0_#01281F_inset] max-lg:max-w-[170px] lg:w-[190px]", children: "\u041F\u0440\u0438\u043C\u0435\u043D\u0438\u0442\u044C" })] })), se = i.memo(({ suggestions: l, onSelect: c }) => e.jsx("ul", { className: "suggestion-list", children: l.map((a) => {
  var _a;
  return e.jsxs("li", { onClick: () => c(a), className: "suggestion-item", children: [e.jsx("h4", { children: a.title.text }), e.jsx("span", { children: (_a = a.subtitle) == null ? void 0 : _a.text })] }, a.distance.value);
}) })), le = i.memo(({ finalPrice: l, discount: c, deliveryPrice: a, appliedPromo: o }) => e.jsxs("div", { className: "summary mt-16 flex flex-col gap-2", children: [e.jsxs("div", { className: "flex gap-24", children: [e.jsx("h2", { className: "font-bold uppercase text-light-turquoise max-lg:text-[20px] lg:text-[30px]", children: "\u041E\u0431\u0449\u0430\u044F \u0441\u0443\u043C\u043C\u0430 \u0437\u0430\u043A\u0430\u0437\u0430" }), e.jsxs("h2", { className: "font-bold uppercase text-light-turquoise max-lg:text-[20px] lg:text-[30px]", children: [l, " \u20BD"] })] }), e.jsxs("div", { className: "flex flex-col gap-4", children: [e.jsxs("h3", { className: "font-normal uppercase max-lg:text-[12px] lg:text-[14px]", children: ["\u0421\u043A\u0438\u0434\u043A\u0430: ", c, " \u20BD (", o == null ? void 0 : o.percentageDiscount, "%)"] }), e.jsxs("h3", { className: "font-normal uppercase max-lg:text-[12px] lg:text-[14px]", children: ["\u0414\u043E\u0441\u0442\u0430\u0432\u043A\u0430: ", a, " \u20BD"] })] })] })), ae = ["\u0421\u0430\u043C\u043E\u0432\u044B\u0432\u043E\u0437", "\u0414\u043E\u0441\u0442\u0430\u0432\u043A\u0430 \u043A\u0443\u0440\u044C\u0435\u0440\u043E\u043C"], oe = ["\u0411\u0430\u043D\u043A\u043E\u0432\u0441\u043A\u0430\u044F \u043A\u0430\u0440\u0442\u0430", "\u041D\u0430\u043B\u0438\u0447\u043D\u044B\u043C\u0438", "Apple pay", "Google pay", "\u041A\u0440\u0438\u043F\u0442\u043E\u0432\u0430\u043B\u044E\u0442\u0430", "\u0421 \u0440\u0430\u0441\u0447\u0435\u0442\u043D\u043E\u0433\u043E \u0441\u0447\u0435\u0442\u0430"], ce = { name: "", phone: "", email: "", secondPhone: "", receiverName: "", comment: "", deliveryRadioGroup: "\u0421\u0430\u043C\u043E\u0432\u044B\u0432\u043E\u0437", payRadioGroupOptions: "\u0411\u0430\u043D\u043A\u043E\u0432\u0441\u043A\u0430\u044F \u043A\u0430\u0440\u0442\u0430", promoCode: "", address: "", apartmentNumber: "", deliveryTime: "" }, ie = i.memo(({ submitOrder: l, totalPrice: c, sendAlert: a }) => {
  const { register: o, handleSubmit: p, control: g, watch: t, getValues: m, setValue: u, formState: { errors: x } } = Y({ defaultValues: ce }), [j, O] = i.useState(0), [L, R] = i.useState(0), [h, T] = i.useState(c), [_, E] = i.useState(), [N, M] = i.useState(void 0), [z, w] = i.useState(false), k = t("deliveryRadioGroup"), B = t("payRadioGroupOptions"), G = async () => {
    const s = m("promoCode").trim().toLowerCase();
    if (!s) return alert("\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043F\u0440\u043E\u043C\u043E\u043A\u043E\u0434");
    if (N) return alert("\u041F\u0440\u043E\u043C\u043E\u043A\u043E\u0434 \u0443\u0436\u0435 \u043F\u0440\u0438\u043C\u0435\u043D\u0451\u043D");
    const r = await U(s);
    if (!r) return a("error");
    const A = h * r.percentageDiscount / 100;
    O(Number(A.toFixed(2))), T(h - A), M(r), a("success");
  }, U = async (s) => {
    try {
      const { data: r } = await v.get(`http://localhost:3000/api/promocode/${s}`);
      return r;
    } catch (r) {
      console.log(r);
    }
  }, y = $(async () => {
    const s = m("address").trim();
    if (s) try {
      const { data: r } = await v.get(`https://suggest-maps.yandex.ru/v1/suggest?apikey=YOUR_API_KEY&text=${s}&lang=ru&results=20`);
      E(r.results), w(true);
    } catch {
      console.log("\u041E\u0448\u0438\u0431\u043A\u0430 \u043F\u043E\u043B\u0443\u0447\u0435\u043D\u0438\u044F \u0430\u0434\u0440\u0435\u0441\u0430"), a("error");
    }
  }, 350), V = (s) => {
    var _a;
    const r = `${((_a = s.subtitle) == null ? void 0 : _a.text) ?? ""}, ${s.title.text}`;
    u("address", r), R(Math.round(Math.random() * 900 + 100)), w(false);
  }, S = (s) => {
    l(s, h, m("address").trim(), N);
  }, C = (s) => {
    a("error"), console.log(s);
  };
  return e.jsxs("form", { onSubmit: p(S, C), className: "order__forms_block w-[540px]", children: [e.jsxs(f, { title: "\u041A\u043E\u043D\u0442\u0430\u043A\u0442\u043D\u044B\u0435 \u0434\u0430\u043D\u043D\u044B\u0435", children: [e.jsx(n, { label: "\u0412\u0430\u0448\u0435 \u0438\u043C\u044F*", placeholder: "\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0432\u0430\u0448\u0435 \u0438\u043C\u044F", register: o("name", { required: true }), error: x.name }), e.jsx(n, { label: "\u0412\u0430\u0448 \u0442\u0435\u043B\u0435\u0444\u043E\u043D*", placeholder: "+7 (977) 777-77-77", type: "tel", register: o("phone", { required: true }), error: x.phone }), e.jsx(n, { label: "\u0412\u0430\u0448 e-mail*", placeholder: "\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0432\u0430\u0448\u0443 \u043F\u043E\u0447\u0442\u0443", type: "email", register: o("email", { required: true }), error: x.email }), e.jsx(n, { label: "\u0422\u0435\u043B\u0435\u0444\u043E\u043D \u043F\u043E\u043B\u0443\u0447\u0430\u0442\u0435\u043B\u044F (\u043D\u0435\u043E\u0431\u044F\u0437\u0430\u0442\u0435\u043B\u044C\u043D\u043E)", placeholder: "+7 (977) 777-77-77", type: "tel", register: o("secondPhone") }), e.jsx(n, { label: "\u0418\u043C\u044F \u043F\u043E\u043B\u0443\u0447\u0430\u0442\u0435\u043B\u044F (\u043D\u0435\u043E\u0431\u044F\u0437\u0430\u0442\u0435\u043B\u044C\u043D\u043E)", placeholder: "\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0438\u043C\u044F \u043F\u043E\u043B\u0443\u0447\u0430\u0442\u0435\u043B\u044F", register: o("receiverName") }), e.jsx(n, { label: "\u041A\u043E\u043C\u043C\u0435\u043D\u0442\u0430\u0440\u0438\u0439 \u043A \u0437\u0430\u043A\u0430\u0437\u0443", placeholder: "\u041F\u0440\u0438\u043C\u0435\u0447\u0430\u043D\u0438\u044F \u043A \u0432\u0430\u0448\u0435\u043C\u0443 \u0437\u0430\u043A\u0430\u0437\u0443", register: o("comment") })] }), e.jsxs(f, { title: "\u0414\u043E\u0441\u0442\u0430\u0432\u043A\u0430", children: [e.jsx(P, { control: g, name: "deliveryRadioGroup", render: ({ field: s }) => e.jsx(q, { ...s, children: ae.map((r) => e.jsx(F, { value: r, control: e.jsx(I, { sx: { color: b[900], "&.Mui-checked": { color: b[50] } } }), label: r, className: "font-normal uppercase tracking-normal text-[#353535] aria-checked:text-[white]", "aria-checked": k === r }, r)) }) }), k === "\u0414\u043E\u0441\u0442\u0430\u0432\u043A\u0430 \u043A\u0443\u0440\u044C\u0435\u0440\u043E\u043C" && e.jsxs(e.Fragment, { children: [e.jsx(n, { label: "\u0410\u0434\u0440\u0435\u0441*", placeholder: "\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0430\u0434\u0440\u0435\u0441", register: o("address", { required: true, onChange: y }), error: x.address, autoComplete: "off" }), e.jsxs("div", { className: "flex gap-8 max-lg:max-w-[300px]", children: [e.jsx(n, { label: "\u041A\u0432/\u043E\u0444\u0438\u0441", placeholder: "\u041A\u0432/\u043E\u0444\u0438\u0441", register: o("address", { required: true, onChange: y }), error: x.address, autoComplete: "off" }), e.jsx(n, { label: "\u0412\u0440\u0435\u043C\u044F \u0434\u043E\u0441\u0442\u0430\u0432\u043A\u0438", placeholder: "__/__", register: o("address", { required: true, onChange: y }), error: x.address, autoComplete: "off" })] }), z && _ && e.jsx(se, { suggestions: _, onSelect: V })] })] }), e.jsx(f, { title: "\u041E\u043F\u043B\u0430\u0442\u0430", children: e.jsx(P, { control: g, name: "payRadioGroupOptions", render: ({ field: s }) => e.jsx(q, { ...s, children: oe.map((r) => e.jsx(F, { value: r, control: e.jsx(I, { sx: { color: b[900], "&.Mui-checked": { color: b[50] } } }), label: r, className: "font-normal uppercase tracking-normal text-[#353535] aria-checked:text-[white]", "aria-checked": B === r }, r)) }) }) }), e.jsx(f, { title: "\u041F\u0440\u043E\u043C\u043E\u043A\u043E\u0434", children: e.jsx(re, { applyPromoCode: G, register: o("promoCode") }) }), e.jsx(le, { finalPrice: h, discount: j, deliveryPrice: L, appliedPromo: N }), e.jsxs("div", { className: "total_price__button_block flex flex-col gap-[10px] max-lg:mt-5 lg:mt-7", children: [e.jsx("button", { onClick: p(S, C), type: "submit", className: "mt-2 w-[255px] cursor-pointer border border-light-turquoise bg-light-turquoise p-4 text-[12px] font-bold uppercase tracking-[1.2px] text-[black] transition-all hover:border-cherry hover:bg-cherry hover:text-[white] focus:border focus:border-cherry active:bg-cherry active:text-[white] active:shadow-[0_0_10px_0_#1B000E_inset]", children: "\u041A \u043E\u043F\u043B\u0430\u0442\u0435" }), e.jsxs("p", { className: "max-w-[342px] font-roboto_condensed text-[10px] font-normal tracking-[0.2px]", children: ["\u041D\u0430\u0436\u0438\u043C\u0430\u044F \u043D\u0430 \u043A\u043D\u043E\u043F\u043A\u0443 \xAB\u041A \u041E\u043F\u043B\u0430\u0442\u0435\xBB, \u044F \u0434\u0430\u044E \u0441\u0432\u043E\u0435 \u0441\u043E\u0433\u043B\u0430\u0441\u0438\u0435 \u043D\u0430 \u043E\u0431\u0440\u0430\u0431\u043E\u0442\u043A\u0443 \u043F\u0435\u0440\u0441\u043E\u043D\u0430\u043B\u044C\u043D\u044B\u0445 \u0434\u0430\u043D\u043D\u044B\u0445, \u0432 \u0441\u043E\u043E\u0442\u0432\u0435\u0442\u0441\u0442\u0432\u0438\u0438 \u0441", e.jsx("span", { className: "ml-1 text-pink underline", children: "\u041F\u043E\u043B\u0438\u0442\u0438\u043A\u043E\u0439 \u043A\u043E\u043D\u0444\u0438\u0434\u0435\u043D\u0446\u0438\u0430\u043B\u044C\u043D\u043E\u0441\u0442\u0438" }), ", \u0430 \u0442\u0430\u043A \u0436\u0435 \u043E\u0437\u043D\u0430\u043A\u043E\u043C\u043B\u0435\u043D \u0441 \u0443\u0441\u043B\u043E\u0432\u0438\u044F\u043C\u0438 \u043E\u043F\u043B\u0430\u0442\u044B \u0438 \u0434\u043E\u0441\u0442\u0430\u0432\u043A\u0438"] })] })] });
}), xe = [{ text: "\u0413\u043B\u0430\u0432\u043D\u0430\u044F", path: "/" }, { text: "\u043E\u0444\u043E\u0440\u043C\u043B\u0435\u043D\u0438\u0435 \u0437\u0430\u043A\u0430\u0437\u0430", path: "/order" }], ne = "flex items-center lg:h-[100px] lg:text-[100px] font-normal max-lg:text-[40px] font-cormorant tracking-[2px] uppercase", pe = "flex items-center lg:ml-[95px] lg:h-[100px] lg:text-[100px] max-lg:text-[40px] font-normal font-cormorant tracking-[2px] uppercase", me = "order__title lg:mt-16 relative z-10 max-lg:mt-5", be = () => {
  const l = H(), { cartItems: c, totalPrice: a } = D((t) => t.cart), o = i.useCallback((t, m, u, x) => {
    const j = { name: t.name, phoneNumber: t.phone, email: t.email, secondPhoneNumber: t.secondPhone, receiverName: t.receiverName, comment: t.comment, deliveryMethod: t.deliveryRadioGroup, paymentMethod: t.payRadioGroupOptions, cartItems: c, finalPrice: m, ...u && { address: { deliveryAddress: u, apartmentNumber: t.apartmentNumber, deliveryTime: t.deliveryTime } }, ...x && { appliedPromoCode: x } };
    g(j);
  }, [l]), p = i.useCallback((t) => {
    l(K({ modalType: W.Alert, isOpen: true })), l(J({ severity: t }));
  }, [l]), g = async (t) => {
    try {
      await v.post("http://localhost:3000/api/order/", t), p("success");
    } catch (m) {
      console.log("\u041E\u0448\u0438\u0431\u043A\u0430 \u043F\u043E\u0434\u0442\u0432\u0435\u0440\u0436\u0434\u0435\u043D\u0438\u044F \u0437\u0430\u043A\u0430\u0437\u0430", m), p("error");
    }
  };
  return e.jsxs("div", { className: "order_page relative bg-[#040A0A] pt-[120px] max-lg:px-4 max-lg:pb-[150px] lg:pb-[200px]", children: [e.jsx(d, { className: "absolute z-10 w-[217px] -rotate-[71.859deg] rounded-[50%] bg-light-turquoise max-lg:left-[-3rem] max-lg:top-0 max-lg:h-[100px] max-lg:blur-[100px] lg:-left-[4rem] lg:-top-[5rem] lg:h-[174px] lg:blur-[125px]" }), e.jsx(d, { className: "absolute -top-[5rem] right-0 z-10 h-[625px] w-[504px] rounded-[50%] bg-cherry blur-[125px] max-lg:hidden" }), e.jsx(d, { className: "absolute right-0 z-[15] h-[211px] w-[403px] rounded-[50%] bg-light-turquoise max-lg:top-[70rem] max-lg:h-[100px] max-lg:w-[100px] max-lg:blur-[75px] lg:top-[80rem] lg:blur-[125px]" }), e.jsx(d, { className: "absolute z-10 rounded-[50%] bg-cherry max-lg:right-0 max-lg:top-[73rem] max-lg:h-[180px] max-lg:w-[170px] max-lg:blur-[75px] lg:right-[5rem] lg:top-[88rem] lg:h-[365px] lg:w-[355px] lg:blur-[125px]" }), e.jsx("img", { src: "./img/PagesImg/OrderImg/FlowerBgLeft.png", className: "absolute top-0 left-0 z-20" }), e.jsx("img", { src: "./img/PagesImg/OrderImg/FlowerBgFirstRight.png", className: "absolute top-0 right-0 z-20" }), e.jsx("img", { src: "./img/PagesImg/OrderImg/FlowerBgSecondRight.png", className: "absolute top-0 right-0 z-20" }), e.jsxs("div", { className: "order_page__wrapper container relative z-30 mx-auto", children: [e.jsx(Q, { items: xe }), e.jsx(Z, { title: "\u043E\u0444\u043E\u0440\u043C\u043B\u0435\u043D\u0438\u0435", subtitle: "\u0437\u0430\u043A\u0430\u0437\u0430", titleClassName: ne, subtitleClassName: pe, wrapperClassName: me }), e.jsxs("div", { className: "order_block mt-20", children: [e.jsx("h2", { className: "text-[30px] font-bold uppercase text-light-turquoise max-lg:hidden", children: "\u041E\u0444\u043E\u0440\u043C\u043B\u0435\u043D\u0438\u0435 \u0437\u0430\u043A\u0430\u0437\u0430" }), e.jsxs("div", { className: "order__content_block mt-10 flex w-full justify-between", children: [e.jsx(ie, { submitOrder: o, totalPrice: a, sendAlert: p }), e.jsxs("div", { className: "order__cart_items max-lg:hidden", children: [e.jsx("h3", { className: "form_title text-[14px] font-bold uppercase text-light-turquoise", children: "\u0412\u0430\u0448 \u0437\u0430\u043A\u0430\u0437:" }), e.jsx("div", { className: "cart_items mt-11 flex w-[350px] flex-col border-[#555] [&:first-of-type]:border-t", children: c.map((t) => e.jsx(X, { id: t.id, name: t.name, cost: t.cost, imageUrl: t.imageUrl, quantity: t.quantity, dispatch: l }, t.id)) }), e.jsxs("h3", { className: "mt-5 text-[14px] font-bold uppercase tracking-[0.28px] text-light-turquoise", children: ["\u041F\u0440\u0435\u0434\u0432\u0430\u0440\u0438\u0442\u0435\u043B\u044C\u043D\u044B\u0439 \u0438\u0442\u043E\u0433: ", a, " \u0440\u0443\u0431."] })] })] })] })] }), e.jsx(d, { className: "absolute z-10 rotate-[21.097deg] rounded-[50%] bg-light-turquoise max-lg:bottom-[-5rem] max-lg:left-[-6rem] max-lg:h-[100px] max-lg:w-[250px] max-lg:blur-[50px] lg:-bottom-[3rem] lg:left-0 lg:h-[211px] lg:w-[100px] lg:blur-[125px]" }), e.jsx(d, { className: "absolute -bottom-[12rem] right-[35%] z-10 h-[211px] w-[700px] rotate-[21.097deg] rounded-[50%] bg-light-turquoise blur-[125px] max-lg:hidden" }), e.jsx(d, { className: "absolute right-0 z-10 rounded-[50%] bg-cherry max-lg:bottom-[-3rem] max-lg:h-[190px] max-lg:w-[180px] max-lg:blur-[55px] lg:-bottom-[8rem] lg:h-[365px] lg:w-[355px] lg:blur-[125px]" })] });
};
export {
  be as default
};
